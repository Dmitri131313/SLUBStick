#pragma once

#define ARBRW_WRITE 100
#define ARBRW_READ 101
#define ARBRW_PAGETABLE_WALK 102
#define ARBRW_LEAK_KASLR 103
#define ARBRW_OBJ_ALLOC 104
#define ARBRW_OBJ_ALLOC_ACCOUNTED 105
#define ARBRW_OBJ_FREE 106
#define ARBRW_OBJ_READ 107
#define ARBRW_OBJ_WRITE 108
#define ARBRW_ALLOC_AND_COPY_FROM_USER 109

typedef union {
	struct write {
		size_t kaddr;
		size_t value;
	} wr;
	struct read {
		size_t kaddr;
		size_t uaddr;
	} rd;
	struct obj {
		size_t id;
		size_t size;
		size_t uaddr;
	} obj;
	struct pagetable_walk {
		size_t uaddr;
		size_t pgd;
		size_t p4d;
		size_t pud;
		size_t pmd;
		size_t pte;
	} ptw;
} msg_t;